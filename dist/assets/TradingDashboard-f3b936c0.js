import{c as $,r as a,j as e,u as Q,b as _,m as A,d as O,T as V,e as B,f as G,g as ee,S as X,X as P,h as Y,A as I,i as te,t as L,k as se,V as K,C as ae,D as re}from"./index-5e49871b.js";import{z as ne,F as ie}from"./lightweight-charts.production-baeffbd7.js";import{V as Z,E as le}from"./volume-x-ff3d3f5b.js";const ce=$("Bitcoin",[["path",{d:"M11.767 19.089c4.924.868 6.14-6.025 1.216-6.894m-1.216 6.894L5.86 18.047m5.908 1.042-.347 1.97m1.563-8.864c4.924.869 6.14-6.025 1.215-6.893m-1.215 6.893-3.94-.694m5.155-6.2L8.29 4.26m5.908 1.042.348-1.97M7.48 20.364l3.126-17.727",key:"yr8idg"}]]),oe=$("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),de=$("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),me=$("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),xe=$("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),he=$("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),ue=$("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),pe=({symbol:o,data:i=[],height:S=400,showVolume:m=!0,onCrosshairMove:j,theme:b="dark"})=>{var T,f,C,D,M,y;const g=a.useRef(),l=a.useRef(),N=a.useRef(),p=a.useRef(),[x,k]=a.useState(!0);return a.useEffect(()=>{if(!g.current)return;const t={layout:{background:{type:ne.Solid,color:b==="dark"?"#0a0a0a":"#ffffff"},textColor:b==="dark"?"#ffffff":"#000000"},grid:{vertLines:{color:b==="dark"?"#1a1a1a":"#e1e1e1",style:1},horzLines:{color:b==="dark"?"#1a1a1a":"#e1e1e1",style:1}},crosshair:{mode:0,vertLine:{color:"#758695",width:1,style:3},horzLine:{color:"#758695",width:1,style:3}},timeScale:{borderColor:b==="dark"?"#2B2B43":"#cccccc",timeVisible:!0,secondsVisible:!1},rightPriceScale:{borderColor:b==="dark"?"#2B2B43":"#cccccc",scaleMargins:{top:.1,bottom:m?.4:.1}}},s=ie(g.current,{width:g.current.clientWidth,height:S,...t});l.current=s;const r=s.addCandlestickSeries({upColor:"#00ff88",downColor:"#ff4444",borderDownColor:"#ff4444",borderUpColor:"#00ff88",wickDownColor:"#ff4444",wickUpColor:"#00ff88",priceFormat:{type:"price",precision:2,minMove:.01}});if(N.current=r,m){const n=s.addHistogramSeries({color:"#26a69a",priceFormat:{type:"volume"},priceScaleId:"volume",scaleMargins:{top:.8,bottom:0}});p.current=n}j&&s.subscribeCrosshairMove(j);const h=()=>{g.current&&s&&s.applyOptions({width:g.current.clientWidth})};return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h),s&&s.remove()}},[S,m,b,j]),a.useEffect(()=>{if(!(!N.current||!i.length))try{const t=i.map(r=>({time:r.time,open:parseFloat(r.open),high:parseFloat(r.high),low:parseFloat(r.low),close:parseFloat(r.close)})).sort((r,h)=>r.time-h.time),s=i.map(r=>({time:r.time,value:parseFloat(r.volume||0),color:parseFloat(r.close)>=parseFloat(r.open)?"#00ff8840":"#ff444440"})).sort((r,h)=>r.time-h.time);N.current.setData(t),p.current&&m&&p.current.setData(s),l.current&&t.length>0&&l.current.timeScale().fitContent(),k(!1)}catch(t){console.error("Error updating chart data:",t),k(!1)}},[i,m]),e.jsxs("div",{className:"relative w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 px-2",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:o}),i.length>0&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"O:"}),e.jsx("span",{className:"text-white",children:(T=i[i.length-1])==null?void 0:T.open}),e.jsx("span",{className:"text-gray-400",children:"H:"}),e.jsx("span",{className:"text-green-400",children:(f=i[i.length-1])==null?void 0:f.high}),e.jsx("span",{className:"text-gray-400",children:"L:"}),e.jsx("span",{className:"text-red-400",children:(C=i[i.length-1])==null?void 0:C.low}),e.jsx("span",{className:"text-gray-400",children:"C:"}),e.jsx("span",{className:`font-medium ${parseFloat((D=i[i.length-1])==null?void 0:D.close)>=parseFloat((M=i[i.length-1])==null?void 0:M.open)?"text-green-400":"text-red-400"}`,children:(y=i[i.length-1])==null?void 0:y.close})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[x&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-yellow-400",children:"Loading..."})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),e.jsx("span",{className:"text-xs text-green-400",children:"Live"})]})]})]}),e.jsx("div",{ref:g,className:"w-full border border-gray-700 rounded-lg overflow-hidden bg-black",style:{height:`${S}px`}}),x&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full mx-auto mb-2"}),e.jsxs("p",{className:"text-white text-sm",children:["Loading ",o," data..."]})]})})]})},ge=({symbol:o,onClose:i,size:S="normal",position:m={x:0,y:0}})=>{var F,z,q,H;const[j,b]=a.useState(S==="expanded"),[g,l]=a.useState(!0),[N,p]=a.useState(!1),[x,k]=a.useState(null),{candles:T,indicators:f,lastUpdate:C}=Q(o),{setCandles:D,setAlertThreshold:M}=_();a.useEffect(()=>{},[o,D]);const y=T.length>0?T:[],t=y.length>0?y[y.length-1]:null,s=y.length>1?y[y.length-2]:null,r=(t==null?void 0:t.close)||0,h=s?(r-s.close)/s.close*100:0,n=(t==null?void 0:t.volume)||0;a.useEffect(()=>{if(f!=null&&f.atr&&r>0){const w=f.atr/r*100*2;M(o,Math.max(w,1))}},[f,r,o,M]);const d=w=>{if(w.point&&w.time){const J=w.seriesData;if(J.size>0){const W=Array.from(J.values())[0];typeof W=="object"&&W!==null&&k({time:w.time,...W})}}else k(null)},c={mini:{width:300,height:200},normal:{width:500,height:350},expanded:{width:800,height:500}},u=j?"expanded":S,{width:v,height:E}=c[u],R=w=>w>=1e3?`$${w.toLocaleString()}`:`$${w.toFixed(2)}`,U=w=>w>=1e9?`${(w/1e9).toFixed(1)}B`:w>=1e6?`${(w/1e6).toFixed(1)}M`:w>=1e3?`${(w/1e3).toFixed(1)}K`:w.toString();return e.jsxs(A.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"bg-gray-900/95 backdrop-blur-sm border border-gray-700 rounded-xl shadow-2xl overflow-hidden",style:{width:v,height:E+100,position:"absolute",left:m.x,top:m.y,zIndex:10},children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-800/50",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"w-5 h-5 text-blue-400"}),e.jsx("h3",{className:"text-lg font-bold text-white",children:o})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-xl font-mono text-white",children:R(r)}),e.jsxs("div",{className:`flex items-center space-x-1 px-2 py-1 rounded text-sm font-medium ${h>=0?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:[h>=0?e.jsx(V,{className:"w-4 h-4"}):e.jsx(B,{className:"w-4 h-4"}),e.jsxs("span",{children:[h.toFixed(2),"%"]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>l(!g),className:`p-2 rounded-lg transition-colors ${g?"bg-blue-500/20 text-blue-400":"bg-gray-700 text-gray-400"}`,title:"Toggle Volume",children:e.jsx(G,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>p(!N),className:`p-2 rounded-lg transition-colors ${N?"bg-purple-500/20 text-purple-400":"bg-gray-700 text-gray-400"}`,title:"Toggle Indicators",children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>window.location.reload(),className:"p-2 rounded-lg bg-gray-700 hover:bg-gray-600 text-gray-300 transition-colors",title:"Refresh Data",children:e.jsx(X,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>b(!j),className:"p-2 rounded-lg bg-gray-700 hover:bg-gray-600 text-gray-300 transition-colors",title:j?"Minimize":"Expand",children:j?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(me,{className:"w-4 h-4"})}),e.jsx("button",{onClick:i,className:"p-2 rounded-lg bg-red-500/20 hover:bg-red-500/30 text-red-400 transition-colors",title:"Close Chart",children:e.jsx(P,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"px-4 py-2 bg-gray-800/30 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-gray-400",children:["Vol: ",e.jsx("span",{className:"text-white",children:U(n)})]}),f&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-gray-400",children:["RSI: ",e.jsx("span",{className:`${f.rsi>70?"text-red-400":f.rsi<30?"text-green-400":"text-white"}`,children:f.rsi.toFixed(1)})]}),e.jsxs("span",{className:"text-gray-400",children:["ATR: ",e.jsx("span",{className:"text-blue-400",children:f.atr.toFixed(2)})]}),f.bb&&e.jsxs("span",{className:"text-gray-400",children:["BB:",e.jsx("span",{className:"text-yellow-400 ml-1",children:f.bb.upper.toFixed(2)}),"/",e.jsx("span",{className:"text-yellow-400",children:f.bb.lower.toFixed(2)})]})]}),C&&e.jsxs("span",{className:"text-gray-400",children:["Updated: ",e.jsx("span",{className:"text-green-400",children:new Date(C).toLocaleTimeString()})]})]}),x&&e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("span",{className:"text-gray-400",children:"O:"}),e.jsx("span",{className:"text-white",children:(F=x.open)==null?void 0:F.toFixed(2)}),e.jsx("span",{className:"text-gray-400",children:"H:"}),e.jsx("span",{className:"text-green-400",children:(z=x.high)==null?void 0:z.toFixed(2)}),e.jsx("span",{className:"text-gray-400",children:"L:"}),e.jsx("span",{className:"text-red-400",children:(q=x.low)==null?void 0:q.toFixed(2)}),e.jsx("span",{className:"text-gray-400",children:"C:"}),e.jsx("span",{className:"text-white",children:(H=x.close)==null?void 0:H.toFixed(2)})]})]})}),e.jsx("div",{className:"flex-1 p-2",children:y.length===0?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Y,{className:"w-8 h-8 text-red-400 mx-auto mb-2"}),e.jsx("p",{className:"text-red-400 text-sm",children:"No data available"}),e.jsx("p",{className:"text-gray-500 text-xs",children:"Check your data source"}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-2 px-3 py-1 bg-red-500/20 text-red-400 rounded text-xs hover:bg-red-500/30 transition-colors",children:"Retry"})]})}):e.jsx(pe,{symbol:o,data:y,height:E-120,showVolume:g,onCrosshairMove:d,theme:"dark"})})]})},fe=({onAddChart:o,activeCharts:i=[],onRemoveChart:S})=>{const[m,j]=a.useState([]),[b,g]=a.useState(""),[l,N]=a.useState(!1),[p,x]=a.useState("all"),k={stocks:[{symbol:"AAPL",name:"Apple Inc.",category:"stocks"},{symbol:"MSFT",name:"Microsoft Corp.",category:"stocks"},{symbol:"GOOGL",name:"Alphabet Inc.",category:"stocks"},{symbol:"TSLA",name:"Tesla Inc.",category:"stocks"},{symbol:"AMZN",name:"Amazon.com Inc.",category:"stocks"},{symbol:"NVDA",name:"NVIDIA Corp.",category:"stocks"},{symbol:"META",name:"Meta Platforms",category:"stocks"},{symbol:"NFLX",name:"Netflix Inc.",category:"stocks"}],crypto:[{symbol:"BTCUSD",name:"Bitcoin",category:"crypto"},{symbol:"ETHUSD",name:"Ethereum",category:"crypto"},{symbol:"ADAUSD",name:"Cardano",category:"crypto"},{symbol:"SOLUSD",name:"Solana",category:"crypto"},{symbol:"DOTUSD",name:"Polkadot",category:"crypto"},{symbol:"MATICUSD",name:"Polygon",category:"crypto"}]};a.useEffect(()=>{const t=localStorage.getItem("tradingWatchlist");if(t)j(JSON.parse(t));else{const s=[...k.stocks.slice(0,4),...k.crypto.slice(0,2)];j(s),localStorage.setItem("tradingWatchlist",JSON.stringify(s))}},[]);const T=t=>{j(t),localStorage.setItem("tradingWatchlist",JSON.stringify(t))},f=t=>{if(!m.find(s=>s.symbol===t.symbol)){const s=[...m,t];T(s)}N(!1)},C=t=>{const s=m.filter(r=>r.symbol!==t);T(s),S==null||S(t)},M=[...k.stocks,...k.crypto].filter(t=>{const s=t.symbol.toLowerCase().includes(b.toLowerCase())||t.name.toLowerCase().includes(b.toLowerCase()),r=p==="all"||t.category===p;return s&&r}),y=t=>{switch(t){case"stocks":return e.jsx(O,{className:"w-4 h-4"});case"crypto":return e.jsx(ce,{className:"w-4 h-4"});default:return e.jsx(oe,{className:"w-4 h-4"})}};return e.jsxs(e.Fragment,{children:[e.jsxs(A.div,{initial:{x:-300},animate:{x:0},className:"w-80 h-full bg-background/95 backdrop-blur-sm border-r border-primary/30 p-4 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-primary flex items-center",children:[e.jsx(G,{className:"w-5 h-5 mr-2"}),"Watchlist"]}),e.jsx("button",{onClick:()=>N(!0),className:"p-2 bg-primary/20 hover:bg-primary/30 text-primary rounded-lg transition-colors",title:"Add Asset",children:e.jsx(ue,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex space-x-2 mb-4",children:["all","stocks","crypto"].map(t=>e.jsx("button",{onClick:()=>x(t),className:`px-3 py-1 text-xs rounded-full transition-colors ${p===t?"bg-primary/20 text-primary":"bg-background/50 text-muted-foreground hover:text-primary"}`,children:t.charAt(0).toUpperCase()+t.slice(1)},t))}),e.jsx("div",{className:"space-y-2",children:e.jsx(I,{children:m.filter(t=>p==="all"||t.category===p).map((t,s)=>e.jsx(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:s*.05},className:`p-3 rounded-lg border transition-all cursor-pointer ${i.includes(t.symbol)?"border-primary bg-primary/10":"border-border bg-background/50 hover:border-primary/50"}`,onClick:()=>o==null?void 0:o(t.symbol),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded ${t.category==="crypto"?"bg-orange-500/20":"bg-blue-500/20"}`,children:y(t.category)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-foreground",children:t.symbol}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.name})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:`flex items-center text-xs ${Math.random()>.5?"text-green-400":"text-red-400"}`,children:[Math.random()>.5?e.jsx(V,{className:"w-3 h-3"}):e.jsx(B,{className:"w-3 h-3"}),e.jsxs("span",{className:"ml-1",children:[Math.random()>.5?"+":"-",(Math.random()*5).toFixed(2),"%"]})]}),e.jsx("button",{onClick:r=>{r.stopPropagation(),C(t.symbol)},className:"p-1 text-muted-foreground hover:text-destructive opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(P,{className:"w-3 h-3"})})]})]})},t.symbol))})}),i.length>0&&e.jsxs("div",{className:"mt-6 p-3 bg-primary/5 rounded-lg border border-primary/20",children:[e.jsxs("div",{className:"text-xs text-primary font-semibold mb-2",children:["Active Charts (",i.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:i.map(t=>e.jsx("span",{className:"px-2 py-1 bg-primary/20 text-primary text-xs rounded",children:t},t))})]})]}),e.jsx(I,{children:l&&e.jsx(A.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center",onClick:()=>N(!1),children:e.jsxs(A.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-background border border-primary/30 rounded-lg p-6 w-96 max-h-96 overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Add to Watchlist"}),e.jsx("button",{onClick:()=>N(!1),className:"p-1 text-muted-foreground hover:text-primary",children:e.jsx(P,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(te,{className:"absolute left-3 top-3 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"Search assets...",value:b,onChange:t=>g(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-input border border-border rounded-lg text-foreground focus:border-primary focus:outline-none"})]}),e.jsx("div",{className:"flex space-x-2 mb-4",children:["all","stocks","crypto"].map(t=>e.jsx("button",{onClick:()=>x(t),className:`px-3 py-1 text-sm rounded transition-colors ${p===t?"bg-primary/20 text-primary":"bg-background/50 text-muted-foreground hover:text-primary"}`,children:t.charAt(0).toUpperCase()+t.slice(1)},t))}),e.jsx("div",{className:"space-y-2",children:M.map(t=>e.jsx("button",{onClick:()=>f(t),disabled:m.find(s=>s.symbol===t.symbol),className:"w-full p-3 text-left rounded-lg border border-border hover:border-primary/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded ${t.category==="crypto"?"bg-orange-500/20":"bg-blue-500/20"}`,children:y(t.category)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-foreground",children:t.symbol}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.name})]})]})},t.symbol))})]})})})]})},be=({priceData:o={},audioEnabled:i=!0,onToggleAudio:S})=>{a.useState([]);const[m,j]=a.useState([]),[b,g]=a.useState(!1),[l,N]=a.useState({priceChange:5,volume:10,soundEnabled:!0,visualEnabled:!0,frequency:528}),p=a.useRef(null),x=a.useRef(null),k=a.useCallback(()=>{typeof window<"u"&&window.AudioContext&&!p.current&&(p.current=new(window.AudioContext||window.webkitAudioContext))},[]),T=a.useCallback(async(t="default",s=1)=>{if(!(!i||!l.soundEnabled||!p.current))try{if(p.current.state==="suspended"&&await p.current.resume(),x.current)try{x.current.disconnect()}catch{}const r=p.current,h=r.createGain(),n=r.createOscillator();let d,c,u;switch(t){case"priceUp":d=660,c=800,u="sine";break;case"priceDown":d=330,c=1200,u="triangle";break;case"volume":d=440,c=600,u="square";break;default:d=l.frequency,c=1e3,u="sine"}n.connect(h),h.connect(r.destination),n.frequency.setValueAtTime(d,r.currentTime),n.type=u;const v=r.currentTime,E=.1,R=.2,U=.3*s,F=.3;h.gain.setValueAtTime(0,v),h.gain.linearRampToValueAtTime(.6*s,v+E),h.gain.exponentialRampToValueAtTime(U,v+E+R),h.gain.exponentialRampToValueAtTime(.001,v+c/1e3-F),n.start(v),n.stop(v+c/1e3),x.current=n,n.onended=()=>{x.current=null}}catch(r){console.warn("Alert audio failed:",r)}},[i,l.soundEnabled,l.frequency]),f=a.useCallback((t,s)=>{const{price:r,change:h,volume:n,timestamp:d}=s,c=`${t}-${d}`;if(m.find(v=>v.id===c))return;let u=null;Math.abs(h)>=l.priceChange&&(u={id:c,symbol:t,type:h>0?"priceUp":"priceDown",message:`${t} ${h>0?"surged":"dropped"} ${Math.abs(h).toFixed(2)}%`,value:h,timestamp:Date.now(),severity:Math.abs(h)>l.priceChange*2?"high":"medium"}),u&&(j(v=>[u,...v].slice(0,10)),T(u.type,Math.min(Math.abs(u.value)/10,1)),l.visualEnabled&&L({title:"🚨 Price Alert",description:u.message,variant:u.type==="priceDown"?"destructive":"default"}))},[l,m,T]);a.useEffect(()=>{Object.entries(o).forEach(([t,s])=>{f(t,s)})},[o,f]),a.useEffect(()=>(k(),()=>{if(x.current)try{x.current.disconnect()}catch{}p.current&&p.current.state!=="closed"&&p.current.close()}),[k]),a.useEffect(()=>{const t=localStorage.getItem("tradingAlertConfig");if(t)try{const s=JSON.parse(t);N(r=>({...r,...s}))}catch(s){console.warn("Failed to parse saved alert config:",s)}},[]);const C=t=>{N(t),localStorage.setItem("tradingAlertConfig",JSON.stringify(t))},D=t=>{j(s=>s.filter(r=>r.id!==t))},M=()=>{j([])},y=t=>{switch(t){case"priceUp":return e.jsx(V,{className:"w-4 h-4 text-green-400"});case"priceDown":return e.jsx(B,{className:"w-4 h-4 text-red-400"});default:return e.jsx(Y,{className:"w-4 h-4 text-yellow-400"})}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"fixed top-4 right-4 z-40 flex items-center space-x-2",children:[m.length>0&&e.jsx(A.div,{initial:{scale:0},animate:{scale:1},className:"relative",children:e.jsxs("button",{onClick:M,className:"p-2 bg-destructive/20 hover:bg-destructive/30 text-destructive rounded-lg transition-colors",title:`${m.length} active alerts`,children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{className:"absolute -top-1 -right-1 bg-destructive text-destructive-foreground text-xs rounded-full h-5 w-5 flex items-center justify-center",children:m.length})]})}),e.jsx("button",{onClick:S,className:`p-2 rounded-lg transition-colors ${i&&l.soundEnabled?"bg-primary/20 text-primary":"bg-background/50 text-muted-foreground"}`,title:"Toggle Alert Sounds",children:i&&l.soundEnabled?e.jsx(K,{className:"w-4 h-4"}):e.jsx(Z,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>g(!b),className:`p-2 rounded-lg transition-colors ${b?"bg-primary/20 text-primary":"bg-background/50 text-muted-foreground hover:text-primary"}`,title:"Alert Settings",children:e.jsx(X,{className:"w-4 h-4"})})]}),e.jsx(I,{children:m.length>0&&e.jsx(A.div,{initial:{opacity:0,x:300},animate:{opacity:1,x:0},exit:{opacity:0,x:300},className:"fixed top-20 right-4 w-80 max-h-96 overflow-y-auto z-30",children:e.jsxs("div",{className:"bg-background/95 backdrop-blur-sm border border-primary/30 rounded-lg p-4 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-primary",children:"Active Alerts"}),e.jsx("button",{onClick:M,className:"text-xs text-muted-foreground hover:text-primary",children:"Clear All"})]}),e.jsx("div",{className:"space-y-2",children:m.map((t,s)=>e.jsx(A.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:s*.1},className:`p-3 rounded-lg border ${t.severity==="high"?"border-destructive bg-destructive/10":"border-border bg-background/50"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[y(t.type),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-foreground",children:t.message}),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(t.timestamp).toLocaleTimeString()})]})]}),e.jsx("button",{onClick:()=>D(t.id),className:"p-1 text-muted-foreground hover:text-primary ml-2",children:e.jsx(P,{className:"w-3 h-3"})})]})},t.id))})]})})}),e.jsx(I,{children:b&&e.jsx(A.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center",onClick:()=>g(!1),children:e.jsxs(A.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-background border border-primary/30 rounded-lg p-6 w-96",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Alert Settings"}),e.jsx("button",{onClick:()=>g(!1),className:"p-1 text-muted-foreground hover:text-primary",children:e.jsx(P,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Price Change Threshold (%)"}),e.jsx("input",{type:"range",min:"1",max:"20",value:l.priceChange,onChange:t=>C({...l,priceChange:Number(t.target.value)}),className:"w-full"}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Alert when price changes by ±",l.priceChange,"%"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Alert Frequency (Hz)"}),e.jsx("input",{type:"range",min:"200",max:"1000",value:l.frequency,onChange:t=>C({...l,frequency:Number(t.target.value)}),className:"w-full"}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[l.frequency," Hz"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l.soundEnabled,onChange:t=>C({...l,soundEnabled:t.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm text-foreground",children:"Sound Alerts"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l.visualEnabled,onChange:t=>C({...l,visualEnabled:t.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm text-foreground",children:"Visual Notifications"})]})]}),e.jsx("button",{onClick:()=>T("default",.8),className:"w-full px-4 py-2 bg-primary/20 hover:bg-primary/30 text-primary rounded-lg transition-colors",disabled:!i||!l.soundEnabled,children:"Test Alert Sound"})]})]})})})]})},ve=()=>{const[o,i]=a.useState([]),[S,m]=a.useState({}),[j,b]=a.useState({}),[g,l]=a.useState("normal"),[N,p]=a.useState(!0),[x,k]=a.useState(!0);a.useState(!1);const[T,f]=a.useState(new Date);a.useState("auto");const C=a.useRef(null),D=a.useCallback(n=>{if(o.includes(n)){L({title:"Chart Already Active",description:`${n} is already being displayed`,variant:"destructive"});return}if(o.length>=6){L({title:"Maximum Charts Reached",description:"You can display up to 6 charts simultaneously",variant:"destructive"});return}i(c=>[...c,n]);const d=y(o.length);m(c=>({...c,[n]:d})),L({title:"📊 Chart Added",description:`${n} chart is now active`})},[o]),M=a.useCallback(n=>{i(d=>d.filter(c=>c!==n)),m(d=>{const{[n]:c,...u}=d;return u}),b(d=>{const{[n]:c,...u}=d;return u}),L({title:"Chart Removed",description:`${n} chart has been closed`})},[]),y=n=>{var F,z;const d=((F=C.current)==null?void 0:F.clientWidth)||1200;(z=C.current)!=null&&z.clientHeight;const c=400,u=300,v=20,E=Math.floor((d-320)/(c+v)),R=Math.floor(n/E);return{x:320+n%E*(c+v)+v,y:R*(u+v)+80+v}},t=a.useCallback(n=>{b(d=>({...d,[n.symbol]:{price:n.price,change:n.change,timestamp:Date.now()}}))},[]),s=()=>{const n={};o.forEach((d,c)=>{n[d]=y(c)}),m(n),L({title:"📐 Charts Rearranged",description:"Chart positions have been optimized"})},r=()=>{const n={activeCharts:o,chartPositions:S,dashboardMode:g,timestamp:new Date().toISOString()},d=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),c=URL.createObjectURL(d),u=document.createElement("a");u.href=c,u.download=`trading-dashboard-${new Date().toISOString().split("T")[0]}.json`,u.click(),URL.revokeObjectURL(c),L({title:"💾 Dashboard Exported",description:"Your dashboard configuration has been saved"})},h={normal:"bg-background",immersive:"bg-gradient-to-br from-slate-900/50 to-blue-900/30",minimal:"bg-background/95"};return a.useEffect(()=>{const n=setInterval(()=>{f(new Date)},6e4);return()=>clearInterval(n)},[]),a.useEffect(()=>{["AAPL","BTCUSD"].forEach((d,c)=>{setTimeout(()=>D(d),c*500)})},[]),e.jsxs(A.div,{ref:C,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:`h-screen w-full flex ${h[g]} relative overflow-hidden`,children:[e.jsx(A.header,{className:"absolute top-0 left-0 right-0 z-20 p-4 bg-background/95 backdrop-blur-sm border-b border-primary/30",initial:{y:-100},animate:{y:0},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(A.h1,{className:"text-2xl font-bold text-primary flex items-center",whileHover:{scale:1.05},children:[e.jsx(O,{className:"w-6 h-6 mr-2"}),"TradingVision Pro"]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsxs("span",{children:["Last update: ",T.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>p(!N),className:`p-2 rounded-lg transition-colors ${N?"bg-primary/20 text-primary":"bg-background/50 text-muted-foreground"}`,title:"Toggle Watchlist",children:e.jsx(de,{className:"w-4 h-4"})}),e.jsx("button",{onClick:s,className:"p-2 bg-background/50 hover:bg-primary/20 text-muted-foreground hover:text-primary rounded-lg transition-colors",title:"Auto Arrange Charts",children:e.jsx(he,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>l(g==="normal"?"immersive":g==="immersive"?"minimal":"normal"),className:"p-2 bg-background/50 hover:bg-primary/20 text-muted-foreground hover:text-primary rounded-lg transition-colors",title:"Dashboard Mode",children:e.jsx(le,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>k(!x),className:`p-2 rounded-lg transition-colors ${x?"bg-primary/20 text-primary":"bg-background/50 text-muted-foreground"}`,title:"Toggle Audio",children:x?e.jsx(K,{className:"w-4 h-4"}):e.jsx(Z,{className:"w-4 h-4"})}),e.jsx("button",{onClick:r,className:"p-2 bg-background/50 hover:bg-primary/20 text-muted-foreground hover:text-primary rounded-lg transition-colors",title:"Export Dashboard",children:e.jsx(re,{className:"w-4 h-4"})})]})]})}),e.jsxs("div",{className:"flex w-full h-full pt-20",children:[e.jsx(I,{children:N&&e.jsx(fe,{onAddChart:D,activeCharts:o,onRemoveChart:M})}),e.jsxs("div",{className:"flex-1 relative overflow-hidden",children:[e.jsx(I,{children:o.map(n=>e.jsx(ge,{symbol:n,position:S[n]||{x:0,y:0},onClose:()=>M(n),onAlert:t,audioEnabled:x,size:g==="minimal"?"mini":"normal"},n))}),o.length===0&&e.jsx(A.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(O,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground mb-2",children:"Welcome to TradingVision Pro"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Select assets from the watchlist to start analyzing market data"}),e.jsx("button",{onClick:()=>D("AAPL"),className:"px-4 py-2 bg-primary/20 hover:bg-primary/30 text-primary rounded-lg transition-colors",children:"Add Apple Stock Chart"})]})})]})]}),e.jsx(be,{priceData:j,audioEnabled:x,onToggleAudio:()=>k(!x)}),e.jsx(A.div,{className:"absolute bottom-0 left-0 right-0 p-2 bg-background/80 backdrop-blur-sm border-t border-primary/20 text-xs text-muted-foreground",initial:{y:100},animate:{y:0},transition:{delay:.5},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:["Active Charts: ",o.length,"/6"]}),e.jsxs("span",{children:["Mode: ",g]}),e.jsxs("span",{children:["Audio: ",x?"ON":"OFF"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{children:"Market Data Connected"})]})]})})]})};export{ve as default};
