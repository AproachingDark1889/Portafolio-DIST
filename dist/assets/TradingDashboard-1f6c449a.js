import{c as F,r as a,j as e,u as re,b as ne,m as T,d as U,T as V,e as W,f as Y,g as ie,S as Z,X as R,h as K,A as I,i as le,t as E,k as ce,V as Q,C as oe,D as de}from"./index-f85a6274.js";import{z as me,F as xe}from"./lightweight-charts.production-baeffbd7.js";import{V as _,E as he}from"./volume-x-c64e53b8.js";const ue=F("Bitcoin",[["path",{d:"M11.767 19.089c4.924.868 6.14-6.025 1.216-6.894m-1.216 6.894L5.86 18.047m5.908 1.042-.347 1.97m1.563-8.864c4.924.869 6.14-6.025 1.215-6.893m-1.215 6.893-3.94-.694m5.155-6.2L8.29 4.26m5.908 1.042.348-1.97M7.48 20.364l3.126-17.727",key:"yr8idg"}]]),pe=F("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),ge=F("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),fe=F("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),be=F("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),ye=F("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),je=F("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Ne=({symbol:l,data:n=[],height:w=400,showVolume:u=!0,onCrosshairMove:k,theme:g="dark"})=>{var b,S,o,v,A,M;const m=a.useRef(),c=a.useRef(),f=a.useRef(),x=a.useRef(),[p,j]=a.useState(!0);return a.useEffect(()=>{if(!m.current)return;const t={layout:{background:{type:me.Solid,color:g==="dark"?"#0a0a0a":"#ffffff"},textColor:g==="dark"?"#ffffff":"#000000"},grid:{vertLines:{color:g==="dark"?"#1a1a1a":"#e1e1e1",style:1},horzLines:{color:g==="dark"?"#1a1a1a":"#e1e1e1",style:1}},crosshair:{mode:0,vertLine:{color:"#758695",width:1,style:3},horzLine:{color:"#758695",width:1,style:3}},timeScale:{borderColor:g==="dark"?"#2B2B43":"#cccccc",timeVisible:!0,secondsVisible:!1},rightPriceScale:{borderColor:g==="dark"?"#2B2B43":"#cccccc",scaleMargins:{top:.1,bottom:u?.4:.1}}},s=xe(m.current,{width:m.current.clientWidth,height:w,...t});c.current=s;const r=s.addCandlestickSeries({upColor:"#00ff88",downColor:"#ff4444",borderDownColor:"#ff4444",borderUpColor:"#00ff88",wickDownColor:"#ff4444",wickUpColor:"#00ff88",priceFormat:{type:"price",precision:2,minMove:.01}});if(f.current=r,u){const i=s.addHistogramSeries({color:"#26a69a",priceFormat:{type:"volume"},priceScaleId:"volume",scaleMargins:{top:.8,bottom:0}});x.current=i}k&&s.subscribeCrosshairMove(k);const N=()=>{m.current&&s&&s.applyOptions({width:m.current.clientWidth})};return window.addEventListener("resize",N),()=>{window.removeEventListener("resize",N),s&&s.remove()}},[w,u,g,k]),a.useEffect(()=>{if(!(!f.current||!n.length))try{const t=n.map(r=>({time:r.time,open:parseFloat(r.open),high:parseFloat(r.high),low:parseFloat(r.low),close:parseFloat(r.close)})).sort((r,N)=>r.time-N.time),s=n.map(r=>({time:r.time,value:parseFloat(r.volume||0),color:parseFloat(r.close)>=parseFloat(r.open)?"#00ff8840":"#ff444440"})).sort((r,N)=>r.time-N.time);f.current.setData(t),x.current&&u&&x.current.setData(s),c.current&&t.length>0&&c.current.timeScale().fitContent(),j(!1)}catch(t){console.error("Error updating chart data:",t),j(!1)}},[n,u]),e.jsxs("div",{className:"relative w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 px-2",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:l}),n.length>0&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"O:"}),e.jsx("span",{className:"text-white",children:(b=n[n.length-1])==null?void 0:b.open}),e.jsx("span",{className:"text-gray-400",children:"H:"}),e.jsx("span",{className:"text-green-400",children:(S=n[n.length-1])==null?void 0:S.high}),e.jsx("span",{className:"text-gray-400",children:"L:"}),e.jsx("span",{className:"text-red-400",children:(o=n[n.length-1])==null?void 0:o.low}),e.jsx("span",{className:"text-gray-400",children:"C:"}),e.jsx("span",{className:`font-medium ${parseFloat((v=n[n.length-1])==null?void 0:v.close)>=parseFloat((A=n[n.length-1])==null?void 0:A.open)?"text-green-400":"text-red-400"}`,children:(M=n[n.length-1])==null?void 0:M.close})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[p&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-yellow-400",children:"Loading..."})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),e.jsx("span",{className:"text-xs text-green-400",children:"Live"})]})]})]}),e.jsx("div",{ref:m,className:"w-full border border-gray-700 rounded-lg overflow-hidden bg-black",style:{height:`${w}px`}}),p&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full mx-auto mb-2"}),e.jsxs("p",{className:"text-white text-sm",children:["Loading ",l," data..."]})]})})]})},ve=(l,n=100)=>{const w=[],u=Date.now(),k=24*60*60*1e3;let m={BTC:67e3,ETH:3800,AAPL:175,GOOGL:135,TSLA:240,NVDA:880,MSFT:415,AMZN:185}[l]||100;const c=l.includes("BTC")||l.includes("ETH")?.03:.02;for(let f=n;f>=0;f--){const x=Math.floor((u-f*k)/1e3),p=Math.sin(f/20)*.001,j=(Math.random()-.5)*c,b=(p+j)*m;m+=b;const S=m,o=Math.random()*.02,v=S*(1+Math.random()*o),A=S*(1-Math.random()*o),M=A+(v-A)*Math.random(),t=l.includes("BTC")?2e9:5e7,s=Math.abs(b/m)*5+.5,r=t*s*(.5+Math.random());w.push({time:x*1e3,open:S,high:v,low:A,close:M,volume:Math.floor(r)})}return w},we=l=>{const n=l.map(s=>s.close),w=l.map(s=>s.volume);if(n.length===0)return{rsi:50,atr:1,bb:{upper:100,middle:99,lower:98},macd:{MACD:0,signal:0,histogram:0},volumeMA:1e6,ema12:100,ema26:99,series:{rsi:[50],bb:[{upper:100,middle:99,lower:98}],macd:[{MACD:0,signal:0,histogram:0}],ema12:[100],ema26:[99]}};const u=50+(Math.random()-.5)*40,k=l.reduce((s,r)=>s+(r.high-r.low),0)/l.length,g=n[n.length-1]||100,m=g,c=g*.98,f=n.slice(-20).reduce((s,r)=>s+r,0)/Math.min(20,n.length),x=n.slice(-20).reduce((s,r)=>s+Math.pow(r-f,2),0)/Math.min(20,n.length),p=Math.sqrt(x),j={upper:f+2*p,middle:f,lower:f-2*p},b=m-c,S=b*.9,o=b-S,v={MACD:b,signal:S,histogram:o},A=w.slice(-20).reduce((s,r)=>s+r,0)/Math.min(20,w.length),M=Math.min(20,l.length),t={rsi:Array.from({length:M},()=>50+(Math.random()-.5)*40),bb:Array.from({length:M},()=>j),macd:Array.from({length:M},()=>v),ema12:Array.from({length:M},()=>m+(Math.random()-.5)*10),ema26:Array.from({length:M},()=>c+(Math.random()-.5)*10)};return{rsi:u,atr:k,bb:j,macd:v,volumeMA:A,ema12:m,ema26:c,series:t}},ke=l=>{const[n,w]=a.useState([]),[u,k]=a.useState(!0),[g,m]=a.useState(null),[c,f]=a.useState(null),x=a.useRef(null),[p,j]=a.useState(l),b=a.useCallback(()=>{try{k(!0),m(null);const v=ve(p,100),A=we(v);w(v),f(A),k(!1)}catch{m("Error generating candlestick data"),k(!1)}},[p]),S=a.useCallback(v=>{j(v)},[]),o=a.useCallback(()=>{b()},[b]);return a.useEffect(()=>(b(),x.current=setInterval(()=>{b()},5e3),()=>{x.current&&clearInterval(x.current)}),[b]),{data:n,loading:u,error:g,indicators:c,refetch:o,updateSymbol:S}},Ce=({symbol:l,onClose:n,size:w="normal",position:u={x:0,y:0},isDemo:k=!1})=>{var q,H,G,J;const[g,m]=a.useState(w==="expanded"),[c,f]=a.useState(!0),[x,p]=a.useState(!1),[j,b]=a.useState(null),{candles:S,indicators:o,lastUpdate:v}=re(l),{setCandles:A,audioEnabled:M,setAlertThreshold:t}=ne(),{data:s,isLoading:r,error:N,refresh:i}=ke(l);a.useEffect(()=>{s.length>0&&A(l,s)},[s,l,A]);const h=S.length>0?S:s,d=h.length>0?h[h.length-1]:null,y=h.length>1?h[h.length-2]:null,C=(d==null?void 0:d.close)||0,L=y?(C-y.close)/y.close*100:0,P=(d==null?void 0:d.volume)||0;a.useEffect(()=>{if(o!=null&&o.atr&&C>0){const D=o.atr/C*100*2;t(l,Math.max(D,1))}},[o,C,l,t]);const O=D=>{if(D.point&&D.time){const X=D.seriesData;if(X.size>0){const ae=Array.from(X.values())[0];b({time:D.time,...ae})}}else b(null)},$={mini:{width:300,height:200},normal:{width:500,height:350},expanded:{width:800,height:500}},z=g?"expanded":w,{width:ee,height:B}=$[z],te=D=>D>=1e3?`$${D.toLocaleString()}`:`$${D.toFixed(2)}`,se=D=>D>=1e9?`${(D/1e9).toFixed(1)}B`:D>=1e6?`${(D/1e6).toFixed(1)}M`:D>=1e3?`${(D/1e3).toFixed(1)}K`:D.toString();return e.jsxs(T.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"bg-gray-900/95 backdrop-blur-sm border border-gray-700 rounded-xl shadow-2xl overflow-hidden",style:{width:ee,height:B+100,position:"absolute",left:u.x,top:u.y,zIndex:10},children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700 bg-gray-800/50",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(U,{className:"w-5 h-5 text-blue-400"}),e.jsx("h3",{className:"text-lg font-bold text-white",children:l})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-xl font-mono text-white",children:te(C)}),e.jsxs("div",{className:`flex items-center space-x-1 px-2 py-1 rounded text-sm font-medium ${L>=0?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:[L>=0?e.jsx(V,{className:"w-4 h-4"}):e.jsx(W,{className:"w-4 h-4"}),e.jsxs("span",{children:[L.toFixed(2),"%"]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>f(!c),className:`p-2 rounded-lg transition-colors ${c?"bg-blue-500/20 text-blue-400":"bg-gray-700 text-gray-400"}`,title:"Toggle Volume",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>p(!x),className:`p-2 rounded-lg transition-colors ${x?"bg-purple-500/20 text-purple-400":"bg-gray-700 text-gray-400"}`,title:"Toggle Indicators",children:e.jsx(ie,{className:"w-4 h-4"})}),e.jsx("button",{onClick:i,className:"p-2 rounded-lg bg-gray-700 hover:bg-gray-600 text-gray-300 transition-colors",title:"Refresh Data",children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>m(!g),className:"p-2 rounded-lg bg-gray-700 hover:bg-gray-600 text-gray-300 transition-colors",title:g?"Minimize":"Expand",children:g?e.jsx(be,{className:"w-4 h-4"}):e.jsx(fe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:n,className:"p-2 rounded-lg bg-red-500/20 hover:bg-red-500/30 text-red-400 transition-colors",title:"Close Chart",children:e.jsx(R,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"px-4 py-2 bg-gray-800/30 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-gray-400",children:["Vol: ",e.jsx("span",{className:"text-white",children:se(P)})]}),o&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-gray-400",children:["RSI: ",e.jsx("span",{className:`${o.rsi>70?"text-red-400":o.rsi<30?"text-green-400":"text-white"}`,children:o.rsi.toFixed(1)})]}),e.jsxs("span",{className:"text-gray-400",children:["ATR: ",e.jsx("span",{className:"text-blue-400",children:o.atr.toFixed(2)})]}),o.bb&&e.jsxs("span",{className:"text-gray-400",children:["BB:",e.jsx("span",{className:"text-yellow-400 ml-1",children:o.bb.upper.toFixed(2)}),"/",e.jsx("span",{className:"text-yellow-400",children:o.bb.lower.toFixed(2)})]})]}),v&&e.jsxs("span",{className:"text-gray-400",children:["Updated: ",e.jsx("span",{className:"text-green-400",children:new Date(v).toLocaleTimeString()})]})]}),j&&e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("span",{className:"text-gray-400",children:"O:"}),e.jsx("span",{className:"text-white",children:(q=j.open)==null?void 0:q.toFixed(2)}),e.jsx("span",{className:"text-gray-400",children:"H:"}),e.jsx("span",{className:"text-green-400",children:(H=j.high)==null?void 0:H.toFixed(2)}),e.jsx("span",{className:"text-gray-400",children:"L:"}),e.jsx("span",{className:"text-red-400",children:(G=j.low)==null?void 0:G.toFixed(2)}),e.jsx("span",{className:"text-gray-400",children:"C:"}),e.jsx("span",{className:"text-white",children:(J=j.close)==null?void 0:J.toFixed(2)})]})]})}),e.jsx("div",{className:"flex-1 p-2",children:N?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(K,{className:"w-8 h-8 text-red-400 mx-auto mb-2"}),e.jsx("p",{className:"text-red-400 text-sm",children:"Failed to load data"}),e.jsx("p",{className:"text-gray-500 text-xs",children:N}),e.jsx("button",{onClick:i,className:"mt-2 px-3 py-1 bg-red-500/20 text-red-400 rounded text-xs hover:bg-red-500/30 transition-colors",children:"Retry"})]})}):e.jsx(Ne,{symbol:l,data:h,height:B-120,showVolume:c,onCrosshairMove:O,theme:"dark"})})]})},Se=({onAddChart:l,activeCharts:n=[],onRemoveChart:w})=>{const[u,k]=a.useState([]),[g,m]=a.useState(""),[c,f]=a.useState(!1),[x,p]=a.useState("all"),j={stocks:[{symbol:"AAPL",name:"Apple Inc.",category:"stocks"},{symbol:"MSFT",name:"Microsoft Corp.",category:"stocks"},{symbol:"GOOGL",name:"Alphabet Inc.",category:"stocks"},{symbol:"TSLA",name:"Tesla Inc.",category:"stocks"},{symbol:"AMZN",name:"Amazon.com Inc.",category:"stocks"},{symbol:"NVDA",name:"NVIDIA Corp.",category:"stocks"},{symbol:"META",name:"Meta Platforms",category:"stocks"},{symbol:"NFLX",name:"Netflix Inc.",category:"stocks"}],crypto:[{symbol:"BTCUSD",name:"Bitcoin",category:"crypto"},{symbol:"ETHUSD",name:"Ethereum",category:"crypto"},{symbol:"ADAUSD",name:"Cardano",category:"crypto"},{symbol:"SOLUSD",name:"Solana",category:"crypto"},{symbol:"DOTUSD",name:"Polkadot",category:"crypto"},{symbol:"MATICUSD",name:"Polygon",category:"crypto"}]};a.useEffect(()=>{const t=localStorage.getItem("tradingWatchlist");if(t)k(JSON.parse(t));else{const s=[...j.stocks.slice(0,4),...j.crypto.slice(0,2)];k(s),localStorage.setItem("tradingWatchlist",JSON.stringify(s))}},[]);const b=t=>{k(t),localStorage.setItem("tradingWatchlist",JSON.stringify(t))},S=t=>{if(!u.find(s=>s.symbol===t.symbol)){const s=[...u,t];b(s)}f(!1)},o=t=>{const s=u.filter(r=>r.symbol!==t);b(s),w==null||w(t)},A=[...j.stocks,...j.crypto].filter(t=>{const s=t.symbol.toLowerCase().includes(g.toLowerCase())||t.name.toLowerCase().includes(g.toLowerCase()),r=x==="all"||t.category===x;return s&&r}),M=t=>{switch(t){case"stocks":return e.jsx(U,{className:"w-4 h-4"});case"crypto":return e.jsx(ue,{className:"w-4 h-4"});default:return e.jsx(pe,{className:"w-4 h-4"})}};return e.jsxs(e.Fragment,{children:[e.jsxs(T.div,{initial:{x:-300},animate:{x:0},className:"w-80 h-full bg-background/95 backdrop-blur-sm border-r border-primary/30 p-4 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-primary flex items-center",children:[e.jsx(Y,{className:"w-5 h-5 mr-2"}),"Watchlist"]}),e.jsx("button",{onClick:()=>f(!0),className:"p-2 bg-primary/20 hover:bg-primary/30 text-primary rounded-lg transition-colors",title:"Add Asset",children:e.jsx(je,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex space-x-2 mb-4",children:["all","stocks","crypto"].map(t=>e.jsx("button",{onClick:()=>p(t),className:`px-3 py-1 text-xs rounded-full transition-colors ${x===t?"bg-primary/20 text-primary":"bg-background/50 text-muted-foreground hover:text-primary"}`,children:t.charAt(0).toUpperCase()+t.slice(1)},t))}),e.jsx("div",{className:"space-y-2",children:e.jsx(I,{children:u.filter(t=>x==="all"||t.category===x).map((t,s)=>e.jsx(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:s*.05},className:`p-3 rounded-lg border transition-all cursor-pointer ${n.includes(t.symbol)?"border-primary bg-primary/10":"border-border bg-background/50 hover:border-primary/50"}`,onClick:()=>l==null?void 0:l(t.symbol),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded ${t.category==="crypto"?"bg-orange-500/20":"bg-blue-500/20"}`,children:M(t.category)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-foreground",children:t.symbol}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.name})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:`flex items-center text-xs ${Math.random()>.5?"text-green-400":"text-red-400"}`,children:[Math.random()>.5?e.jsx(V,{className:"w-3 h-3"}):e.jsx(W,{className:"w-3 h-3"}),e.jsxs("span",{className:"ml-1",children:[Math.random()>.5?"+":"-",(Math.random()*5).toFixed(2),"%"]})]}),e.jsx("button",{onClick:r=>{r.stopPropagation(),o(t.symbol)},className:"p-1 text-muted-foreground hover:text-destructive opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(R,{className:"w-3 h-3"})})]})]})},t.symbol))})}),n.length>0&&e.jsxs("div",{className:"mt-6 p-3 bg-primary/5 rounded-lg border border-primary/20",children:[e.jsxs("div",{className:"text-xs text-primary font-semibold mb-2",children:["Active Charts (",n.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:n.map(t=>e.jsx("span",{className:"px-2 py-1 bg-primary/20 text-primary text-xs rounded",children:t},t))})]})]}),e.jsx(I,{children:c&&e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center",onClick:()=>f(!1),children:e.jsxs(T.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-background border border-primary/30 rounded-lg p-6 w-96 max-h-96 overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Add to Watchlist"}),e.jsx("button",{onClick:()=>f(!1),className:"p-1 text-muted-foreground hover:text-primary",children:e.jsx(R,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(le,{className:"absolute left-3 top-3 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"Search assets...",value:g,onChange:t=>m(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-input border border-border rounded-lg text-foreground focus:border-primary focus:outline-none"})]}),e.jsx("div",{className:"flex space-x-2 mb-4",children:["all","stocks","crypto"].map(t=>e.jsx("button",{onClick:()=>p(t),className:`px-3 py-1 text-sm rounded transition-colors ${x===t?"bg-primary/20 text-primary":"bg-background/50 text-muted-foreground hover:text-primary"}`,children:t.charAt(0).toUpperCase()+t.slice(1)},t))}),e.jsx("div",{className:"space-y-2",children:A.map(t=>e.jsx("button",{onClick:()=>S(t),disabled:u.find(s=>s.symbol===t.symbol),className:"w-full p-3 text-left rounded-lg border border-border hover:border-primary/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded ${t.category==="crypto"?"bg-orange-500/20":"bg-blue-500/20"}`,children:M(t.category)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-foreground",children:t.symbol}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.name})]})]})},t.symbol))})]})})})]})},Ae=({priceData:l={},audioEnabled:n=!0,onToggleAudio:w})=>{a.useState([]);const[u,k]=a.useState([]),[g,m]=a.useState(!1),[c,f]=a.useState({priceChange:5,volume:10,soundEnabled:!0,visualEnabled:!0,frequency:528}),x=a.useRef(null),p=a.useRef(null),j=a.useCallback(()=>{typeof window<"u"&&window.AudioContext&&!x.current&&(x.current=new(window.AudioContext||window.webkitAudioContext))},[]),b=a.useCallback(async(t="default",s=1)=>{if(!(!n||!c.soundEnabled||!x.current))try{if(x.current.state==="suspended"&&await x.current.resume(),p.current)try{p.current.disconnect()}catch{}const r=x.current,N=r.createGain(),i=r.createOscillator();let h,d,y;switch(t){case"priceUp":h=660,d=800,y="sine";break;case"priceDown":h=330,d=1200,y="triangle";break;case"volume":h=440,d=600,y="square";break;default:h=c.frequency,d=1e3,y="sine"}i.connect(N),N.connect(r.destination),i.frequency.setValueAtTime(h,r.currentTime),i.type=y;const C=r.currentTime,L=.1,P=.2,O=.3*s,$=.3;N.gain.setValueAtTime(0,C),N.gain.linearRampToValueAtTime(.6*s,C+L),N.gain.exponentialRampToValueAtTime(O,C+L+P),N.gain.exponentialRampToValueAtTime(.001,C+d/1e3-$),i.start(C),i.stop(C+d/1e3),p.current=i,i.onended=()=>{p.current=null}}catch(r){console.warn("Alert audio failed:",r)}},[n,c.soundEnabled,c.frequency]),S=a.useCallback((t,s)=>{const{price:r,change:N,volume:i,timestamp:h}=s,d=`${t}-${h}`;if(u.find(C=>C.id===d))return;let y=null;Math.abs(N)>=c.priceChange&&(y={id:d,symbol:t,type:N>0?"priceUp":"priceDown",message:`${t} ${N>0?"surged":"dropped"} ${Math.abs(N).toFixed(2)}%`,value:N,timestamp:Date.now(),severity:Math.abs(N)>c.priceChange*2?"high":"medium"}),y&&(k(C=>[y,...C].slice(0,10)),b(y.type,Math.min(Math.abs(y.value)/10,1)),c.visualEnabled&&E({title:"🚨 Price Alert",description:y.message,variant:y.type==="priceDown"?"destructive":"default"}))},[c,u,b]);a.useEffect(()=>{Object.entries(l).forEach(([t,s])=>{S(t,s)})},[l,S]),a.useEffect(()=>(j(),()=>{if(p.current)try{p.current.disconnect()}catch{}x.current&&x.current.state!=="closed"&&x.current.close()}),[j]),a.useEffect(()=>{const t=localStorage.getItem("tradingAlertConfig");t&&f({...c,...JSON.parse(t)})},[]);const o=t=>{f(t),localStorage.setItem("tradingAlertConfig",JSON.stringify(t))},v=t=>{k(s=>s.filter(r=>r.id!==t))},A=()=>{k([])},M=t=>{switch(t){case"priceUp":return e.jsx(V,{className:"w-4 h-4 text-green-400"});case"priceDown":return e.jsx(W,{className:"w-4 h-4 text-red-400"});default:return e.jsx(K,{className:"w-4 h-4 text-yellow-400"})}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"fixed top-4 right-4 z-40 flex items-center space-x-2",children:[u.length>0&&e.jsx(T.div,{initial:{scale:0},animate:{scale:1},className:"relative",children:e.jsxs("button",{onClick:A,className:"p-2 bg-destructive/20 hover:bg-destructive/30 text-destructive rounded-lg transition-colors",title:`${u.length} active alerts`,children:[e.jsx(ce,{className:"w-4 h-4"}),e.jsx("span",{className:"absolute -top-1 -right-1 bg-destructive text-destructive-foreground text-xs rounded-full h-5 w-5 flex items-center justify-center",children:u.length})]})}),e.jsx("button",{onClick:w,className:`p-2 rounded-lg transition-colors ${n&&c.soundEnabled?"bg-primary/20 text-primary":"bg-background/50 text-muted-foreground"}`,title:"Toggle Alert Sounds",children:n&&c.soundEnabled?e.jsx(Q,{className:"w-4 h-4"}):e.jsx(_,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>m(!g),className:`p-2 rounded-lg transition-colors ${g?"bg-primary/20 text-primary":"bg-background/50 text-muted-foreground hover:text-primary"}`,title:"Alert Settings",children:e.jsx(Z,{className:"w-4 h-4"})})]}),e.jsx(I,{children:u.length>0&&e.jsx(T.div,{initial:{opacity:0,x:300},animate:{opacity:1,x:0},exit:{opacity:0,x:300},className:"fixed top-20 right-4 w-80 max-h-96 overflow-y-auto z-30",children:e.jsxs("div",{className:"bg-background/95 backdrop-blur-sm border border-primary/30 rounded-lg p-4 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-primary",children:"Active Alerts"}),e.jsx("button",{onClick:A,className:"text-xs text-muted-foreground hover:text-primary",children:"Clear All"})]}),e.jsx("div",{className:"space-y-2",children:u.map((t,s)=>e.jsx(T.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:s*.1},className:`p-3 rounded-lg border ${t.severity==="high"?"border-destructive bg-destructive/10":"border-border bg-background/50"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[M(t.type),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-foreground",children:t.message}),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(t.timestamp).toLocaleTimeString()})]})]}),e.jsx("button",{onClick:()=>v(t.id),className:"p-1 text-muted-foreground hover:text-primary ml-2",children:e.jsx(R,{className:"w-3 h-3"})})]})},t.id))})]})})}),e.jsx(I,{children:g&&e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center",onClick:()=>m(!1),children:e.jsxs(T.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-background border border-primary/30 rounded-lg p-6 w-96",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Alert Settings"}),e.jsx("button",{onClick:()=>m(!1),className:"p-1 text-muted-foreground hover:text-primary",children:e.jsx(R,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Price Change Threshold (%)"}),e.jsx("input",{type:"range",min:"1",max:"20",value:c.priceChange,onChange:t=>o({...c,priceChange:Number(t.target.value)}),className:"w-full"}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Alert when price changes by ±",c.priceChange,"%"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Alert Frequency (Hz)"}),e.jsx("input",{type:"range",min:"200",max:"1000",value:c.frequency,onChange:t=>o({...c,frequency:Number(t.target.value)}),className:"w-full"}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[c.frequency," Hz"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.soundEnabled,onChange:t=>o({...c,soundEnabled:t.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm text-foreground",children:"Sound Alerts"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c.visualEnabled,onChange:t=>o({...c,visualEnabled:t.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm text-foreground",children:"Visual Notifications"})]})]}),e.jsx("button",{onClick:()=>b("default",.8),className:"w-full px-4 py-2 bg-primary/20 hover:bg-primary/30 text-primary rounded-lg transition-colors",disabled:!n||!c.soundEnabled,children:"Test Alert Sound"})]})]})})})]})},Le=()=>{const[l,n]=a.useState([]),[w,u]=a.useState({}),[k,g]=a.useState({}),[m,c]=a.useState("normal"),[f,x]=a.useState(!0),[p,j]=a.useState(!0);a.useState(!1);const[b,S]=a.useState(new Date);a.useState("auto");const o=a.useRef(null),v=a.useCallback(i=>{if(l.includes(i)){E({title:"Chart Already Active",description:`${i} is already being displayed`,variant:"destructive"});return}if(l.length>=6){E({title:"Maximum Charts Reached",description:"You can display up to 6 charts simultaneously",variant:"destructive"});return}n(d=>[...d,i]);const h=M(l.length);u(d=>({...d,[i]:h})),E({title:"📊 Chart Added",description:`${i} chart is now active`})},[l]),A=a.useCallback(i=>{n(h=>h.filter(d=>d!==i)),u(h=>{const{[i]:d,...y}=h;return y}),g(h=>{const{[i]:d,...y}=h;return y}),E({title:"Chart Removed",description:`${i} chart has been closed`})},[]),M=i=>{var $,z;const h=(($=o.current)==null?void 0:$.clientWidth)||1200;(z=o.current)!=null&&z.clientHeight;const d=400,y=300,C=20,L=Math.floor((h-320)/(d+C)),P=Math.floor(i/L);return{x:320+i%L*(d+C)+C,y:P*(y+C)+80+C}},t=a.useCallback(i=>{g(h=>({...h,[i.symbol]:{price:i.price,change:i.change,timestamp:Date.now()}}))},[]),s=()=>{const i={};l.forEach((h,d)=>{i[h]=M(d)}),u(i),E({title:"📐 Charts Rearranged",description:"Chart positions have been optimized"})},r=()=>{const i={activeCharts:l,chartPositions:w,dashboardMode:m,timestamp:new Date().toISOString()},h=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),d=URL.createObjectURL(h),y=document.createElement("a");y.href=d,y.download=`trading-dashboard-${new Date().toISOString().split("T")[0]}.json`,y.click(),URL.revokeObjectURL(d),E({title:"💾 Dashboard Exported",description:"Your dashboard configuration has been saved"})},N={normal:"bg-background",immersive:"bg-gradient-to-br from-slate-900/50 to-blue-900/30",minimal:"bg-background/95"};return a.useEffect(()=>{const i=setInterval(()=>{S(new Date)},6e4);return()=>clearInterval(i)},[]),a.useEffect(()=>{["AAPL","BTCUSD"].forEach((h,d)=>{setTimeout(()=>v(h),d*500)})},[]),e.jsxs(T.div,{ref:o,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:`h-screen w-full flex ${N[m]} relative overflow-hidden`,children:[e.jsx(T.header,{className:"absolute top-0 left-0 right-0 z-20 p-4 bg-background/95 backdrop-blur-sm border-b border-primary/30",initial:{y:-100},animate:{y:0},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(T.h1,{className:"text-2xl font-bold text-primary flex items-center",whileHover:{scale:1.05},children:[e.jsx(U,{className:"w-6 h-6 mr-2"}),"TradingVision Pro"]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsxs("span",{children:["Last update: ",b.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>x(!f),className:`p-2 rounded-lg transition-colors ${f?"bg-primary/20 text-primary":"bg-background/50 text-muted-foreground"}`,title:"Toggle Watchlist",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx("button",{onClick:s,className:"p-2 bg-background/50 hover:bg-primary/20 text-muted-foreground hover:text-primary rounded-lg transition-colors",title:"Auto Arrange Charts",children:e.jsx(ye,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>c(m==="normal"?"immersive":m==="immersive"?"minimal":"normal"),className:"p-2 bg-background/50 hover:bg-primary/20 text-muted-foreground hover:text-primary rounded-lg transition-colors",title:"Dashboard Mode",children:e.jsx(he,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>j(!p),className:`p-2 rounded-lg transition-colors ${p?"bg-primary/20 text-primary":"bg-background/50 text-muted-foreground"}`,title:"Toggle Audio",children:p?e.jsx(Q,{className:"w-4 h-4"}):e.jsx(_,{className:"w-4 h-4"})}),e.jsx("button",{onClick:r,className:"p-2 bg-background/50 hover:bg-primary/20 text-muted-foreground hover:text-primary rounded-lg transition-colors",title:"Export Dashboard",children:e.jsx(de,{className:"w-4 h-4"})})]})]})}),e.jsxs("div",{className:"flex w-full h-full pt-20",children:[e.jsx(I,{children:f&&e.jsx(Se,{onAddChart:v,activeCharts:l,onRemoveChart:A})}),e.jsxs("div",{className:"flex-1 relative overflow-hidden",children:[e.jsx(I,{children:l.map(i=>e.jsx(Ce,{symbol:i,position:w[i]||{x:0,y:0},onClose:()=>A(i),onAlert:t,audioEnabled:p,size:m==="minimal"?"mini":"normal"},i))}),l.length===0&&e.jsx(T.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(U,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground mb-2",children:"Welcome to TradingVision Pro"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Select assets from the watchlist to start analyzing market data"}),e.jsx("button",{onClick:()=>v("AAPL"),className:"px-4 py-2 bg-primary/20 hover:bg-primary/30 text-primary rounded-lg transition-colors",children:"Add Apple Stock Chart"})]})})]})]}),e.jsx(Ae,{priceData:k,audioEnabled:p,onToggleAudio:()=>j(!p)}),e.jsx(T.div,{className:"absolute bottom-0 left-0 right-0 p-2 bg-background/80 backdrop-blur-sm border-t border-primary/20 text-xs text-muted-foreground",initial:{y:100},animate:{y:0},transition:{delay:.5},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:["Active Charts: ",l.length,"/6"]}),e.jsxs("span",{children:["Mode: ",m]}),e.jsxs("span",{children:["Audio: ",p?"ON":"OFF"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{children:"Market Data Connected"})]})]})})]})};export{Le as default};
